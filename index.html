<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <base target="_top">

        <title>Explorable Explanations</title>
	<!--<link rel="stylesheet" href="../Fonts/Candal/stylesheet.css" type="text/css">-->
	<link rel="stylesheet" href="style.css" type="text/css">

        <script type="text/javascript" src="Lib/mootools-core-1.3.1-full-compat-yc.js"></script>
        <script type="text/javascript" src="Lib/dsp.js"></script>
        <script type="text/javascript" src="Lib/BVTouchable.js"></script>
        <script type="text/javascript" src="Lib/Tangle.js"></script>

        <script type="text/javascript" src="Script/controls.js"></script>
        <script type="text/javascript" src="Script/views.js"></script>
        <!--<script type="text/javascript" src="Script/park.js"></script>-->
        <script type="text/javascript" src="Script/filter.js"></script>
        <!--<script type="text/javascript" src="Script/wikipedia.js"></script>-->
        <script type="text/javascript" src="Script/main.js"></script>

    </head>

    <body>
        <div id="everything">

            <h1>Explorable Explanations</h1>
            <h3>Bret Victor / March 10, 2011</h3>


            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
            <!-- Explorable Examples -->

            <h2 id="explorableExample">2. Explorable Examples</h2>

            <p>The following is a typical description of a digital filter, as you might find in a typical textbook.</p>

            <div id="filterExample">

	        <p>Below is a simplified digital adaptation of the analog state variable filter.</p>

	        <p class="filterSidebar">This topology is particularly useful for embedded audio processing, because <i>F<sub>c</sub></i> (cutoff frequency) and <i>Q</i> (resonance) are controlled by independent coefficients, <i>k<sub>f</sub></i> and <i>k<sub>q</sub></i>.  (With most filters, the coefficients are functions of both parameters, which precludes pre-calculated lookup tables.)</p>

	        <div class="filterIndent">
		    <canvas class="v_stepPlot a_kf showOnDrag" style="left:-50px;top:-10px;" width="48" height="64"></canvas>
		    <canvas class="v_timePlot a_kf showOnDrag" style="left:324px;top:-10px;" width="128" height="64"></canvas>

		    <div class="filterDynamicLabel a_kf format_p3 showOnDrag" style="left:70px; top:4px;"></div>
		    <div class="filterDynamicLabel a_kf format_p3 showOnDrag" style="left:180px; top:4px;"></div>
		    <div class="filterDynamicLabel a_kq format_neg_p3 showOnDrag" style="left:71px; top:48px;"></div>

		    <img src="http://worrydream.com/ExplorableExplanations/Media/FilterSchematic.png" width="325" height="110">
	        </div>

	        <p>The coefficients and transfer function are:</p>

	        <div class="filterIndent">
		    <div class="filterDynamicCoef showOnDrag" style="left:34px;top:0px;width:70px;height:35px;">
			<div style="position:relative;top:9px;left:2px;"><span class="a_kf format_p3"></span></div>
		    </div>
		    <div class="filterDynamicCoef showOnDrag" style="left:141px;top:0px;width:40px;height:35px;">
			<div style="position:relative;top:9px;left:2px;"><span class="a_kq format_p3"></span></div>
		    </div>

		    <div class="filterDynamicCoef showOnDrag" style="left:141px;top:46px;width:40px;height:16px;">
			<div style="position:relative;top:0px;left:2px;"><span class="a_b0 format_p3"></span></div>
		    </div>
		    <div class="filterDynamicCoef showOnDrag" style="left:72px;top:67px;width:91px;height:16px;">
			<div style="position:relative;top:0px;left:58px;"><span class="a_a1neg format_p3"></span></div>
		    </div>
		    <div class="filterDynamicCoef showOnDrag" style="left:196px;top:67px;width:56px;height:16px;">
			<div style="position:relative;top:0px;left:22px;"><span class="a_a2 format_p3"></span></div>
		    </div>

		    <canvas class="v_polePlot a_a1 showOnDrag" width="160" height="160" style="left:276px;top:-36px;"></canvas>

		    <img src="http://worrydream.com/ExplorableExplanations/Media/FilterEquations.png" width="281" height="92">
	        </div>


	        <p>Some example frequency responses:</p>
	        
	        <div class="filterIndent" style="position:relative;">
		    <div class="filterFreqPlot">
			<canvas class="v_freqPlot a_kf1" width="256" height="128"></canvas>
			<div class="c_filterKnob a_kf1"></div>
			<div class="filterParams" style="left:5px;top:0px;">
			    <i>F<sub>c</sub></i> = <span class="a_fc1 format_freq"></span><br>
			    <i>Q</i> = <span class="a_q1 format_p2"></span>
			</div>
			<div class="filterUnstable v_if a_unstable1">Unstable</div>
		    </div>
		    <div class="filterFreqPlot" style="position:absolute; top:0px; left:274px;">
			<canvas class="v_freqPlot a_kf2" width="256" height="128"></canvas>
			<div class="c_filterKnob a_kf2"></div>
			<div class="filterParams" style="left:5px;top:0px;">
			    <i>F<sub>c</sub></i> = <span class="a_fc2 format_freq"></span><br>
			    <i>Q</i> = <span class="a_q2 format_p2"></span>
			</div>
			<div class="filterUnstable v_if a_unstable2">Unstable</div>
		    </div>
	        </div>

	        <div class="a_kf v_audioPlayer"></div>
	        
            </div>

            <p>Our author was kind enough to provide a couple of examples -- many authors would consider the equations enough.  But we care about the filter's
                <i>dynamic</i> behavior -- how the response changes as we vary the parameters <i>F<sub>c</sub></i> and <i>Q</i> -- 
                and two static examples give us little insight.</p>

            <p>Fortunately, this isn't a physical book, so we aren't limited to static examples.  The <span style="color:#00f">blue text</span> indicates that there's something to play with.  Try playing with it.</p>

            <p>We aren't restricted to the author's choice of examples -- we can see the filter's response for any parameters we want.  We can make <strong>discoveries</strong> that the author didn't bother to mention.  (For instance, we see that this filter can have stability problems at low Q.)  As we play, we think of <strong>questions</strong> (In which regions is this filter stable? Where do we start losing the lowpass response?) and we can experiment to answer those questions immediately.</p>

            <h4>Intuition</h4>

            <div class="sidebar">By the way, this frequency response is not simply plotted from the transfer function.  Instead, the impulse response of the actual filter is simulated, and its FFT is shown.  I think this is more honest, and would work even if we allowed the reader to change the filter topology.  (The z-plane pole positions are from the transfer function, however.)</div>

            <p>By watching the result change as we adjust parameters, we can develop an <strong>intuition</strong> for the system's behavior.  This is helped by the figure's use of <strong>multiple representations</strong>.  We are shown <i>six</i> different ways of characterizing the filter:</p>

            <p style="margin-left:30px; margin-top:20px;"><img src="http://worrydream.com/ExplorableExplanations/Media/FilterRepresentations.png" width="571" height="63"></p>

            <p>Each representation gives a unique insight.  By watching how they all respond to our experimentation, and how they dance with one another, we can develop a deep understanding -- of not just this filter topology, but digital filtering in general.  Exploring the filter space becomes a game.</p>

            <div id="filterAudioSwitch"></div>

            <p>Incidentally, non-engineers may appreciate yet another representation.  Flip the switch to the left, and try playing again.</p>


        </div>
    </body></html>
